# CSP Report Handler Sanitization Examples

## 1. Sanitized Log Example (Oversized CSP Report)
```
2025-08-14T20:15:30.123Z WARNING CSP Violation [enforce]: script-src blocked data:text/javascript,alert('xss') on https://app.example.com/dashboard
2025-08-14T20:15:30.124Z DEBUG   Document URI: https://app.example.com/dashboard  
2025-08-14T20:15:30.124Z DEBUG   Violated Directive: script-src
2025-08-14T20:15:30.124Z DEBUG   Blocked URI: data:text/javascript,alert('xss')[TRUNCATED_PAYLOAD_4096_CHARS]
2025-08-14T20:15:30.124Z DEBUG   Original Policy: default-src 'self'; script-src 'self'; style-src...[TRUNCATED_200_CHARS]
2025-08-14T20:15:30.124Z INFO CSP Analysis: Data URI script blocked - consider allowing 'data:' in script-src
```

## 2. Original Oversized Payload (truncated for display)
```json
POST /csp/report HTTP/1.1
Content-Type: application/csp-report
Content-Length: 8192

{
  "csp-report": {
    "document-uri": "https://app.example.com/dashboard",
    "referrer": "",
    "violated-directive": "script-src",
    "effective-directive": "script-src",
    "original-policy": "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; object-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; connect-src 'self'; upgrade-insecure-requests; report-uri /csp/report",
    "disposition": "enforce",
    "blocked-uri": "data:text/javascript,alert('This is a very long malicious payload designed to test CSP report handling with large payloads that could potentially be used for DoS attacks or log injection...[CONTINUES FOR 4096+ CHARACTERS]",
    "line-number": 42,
    "column-number": 15,
    "source-file": "https://app.example.com/static/js/malicious.js",
    "status-code": 200,
    "sample": "alert('xss attempt with very long payload...[TRUNCATED]"
  }
}
```

## Original Length: 8192 bytes
## Truncated Length: 256 bytes (blocked-uri truncated to prevent log pollution)

## Sanitization Applied:
- ✅ Large blocked-uri truncated with [TRUNCATED_PAYLOAD_4096_CHARS] indicator
- ✅ Original policy truncated to first 200 characters with [TRUNCATED_200_CHARS] indicator  
- ✅ Log entries contain structured metadata for analysis without full payload exposure
- ✅ CSP violation analysis provided for common patterns (data: URI script blocking)
