<!DOCTYPE html>
<html>
  <head>
    <title>Batch Predictions Test</title>
  </head>
  <body>
    <h1>Batch Predictions Test</h1>
    <div id="results"></div>

    <script>
      async function testBatchPredictions() {
        const resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML = "Testing batch predictions...";

        try {
          // Test with sample props
          const sampleProps = [
            {
              id: "test1",
              player: "Test Player 1",
              stat: "hits",
              line: 1.5,
              overOdds: -110,
              underOdds: -110,
              confidence: 75,
              sport: "MLB",
              gameTime: "2025-08-02T21:00:00Z",
              pickType: "player",
            },
            {
              id: "test2",
              player: "Test Player 2",
              stat: "runs",
              line: 0.5,
              overOdds: -120,
              underOdds: +100,
              confidence: 85,
              sport: "MLB",
              gameTime: "2025-08-02T21:00:00Z",
              pickType: "player",
            },
          ];

          console.log("Sending batch request with props:", sampleProps);

          const response = await fetch(
            "http://localhost:8000/api/unified/batch-predictions",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(sampleProps),
            }
          );

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const data = await response.json();
          console.log("Backend response:", data);

          resultsDiv.innerHTML = `
                    <h2>✅ Batch Predictions Working!</h2>
                    <p><strong>Sent:</strong> ${sampleProps.length} props</p>
                    <p><strong>Received:</strong> ${
                      data.predictions ? data.predictions.length : 0
                    } predictions</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
        } catch (error) {
          console.error("Batch predictions test failed:", error);
          resultsDiv.innerHTML = `
                    <h2>❌ Batch Predictions Failed</h2>
                    <p>Error: ${error.message}</p>
                `;
        }
      }

      // Auto-run test when page loads
      window.onload = testBatchPredictions;
    </script>
  </body>
</html>
