# CSP Header Samples - Strict Mode & Connect-Src

## 1. CSP Header when SECURITY_STRICT_MODE=true (ENFORCEMENT MODE)
Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; object-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; connect-src 'self'; upgrade-insecure-requests; report-uri /csp/report

## 2. CSP Header with CSP_EXTRA_CONNECT_SRC="https://api.example.com,wss://stream.example.com"
Content-Security-Policy-Report-Only: default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; object-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; connect-src 'self' https://api.example.com wss://stream.example.com; upgrade-insecure-requests; report-uri /csp/report

## Key Points:
### STRICT MODE BEHAVIOR:
- Forces Content-Security-Policy (not Content-Security-Policy-Report-Only)
- Overrides csp_report_only=true when security_strict_mode=true
- Enforces CSP violations instead of just reporting them

### CONNECT-SRC DIRECTIVE (highlighted):
**Line 2 connect-src directive:** connect-src 'self' https://api.example.com wss://stream.example.com
- Allows connections to self (same origin)
- Allows HTTPS API connections to api.example.com  
- Allows WebSocket connections to stream.example.com
- Additional sources parsed from comma-separated CSP_EXTRA_CONNECT_SRC
